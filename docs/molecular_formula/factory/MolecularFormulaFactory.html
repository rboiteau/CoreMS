<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1" />
<meta name="generator" content="pdoc 0.9.2" />
<title>corems.molecular_formula.factory.MolecularFormulaFactory API documentation</title>
<meta name="description" content="" />
<link rel="preload stylesheet" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/11.0.1/sanitize.min.css" integrity="sha256-PK9q560IAAa6WVRRh76LtCaI8pjTJ2z11v0miyNNjrs=" crossorigin>
<link rel="preload stylesheet" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/11.0.1/typography.min.css" integrity="sha256-7l/o7C8jubJiy74VsKTidCy1yBkRtiUGbVkYBylBqUg=" crossorigin>
<link rel="stylesheet preload" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/styles/github.min.css" crossorigin>
<style>:root{--highlight-color:#fe9}.flex{display:flex !important}body{line-height:1.5em}#content{padding:20px}#sidebar{padding:30px;overflow:hidden}#sidebar > *:last-child{margin-bottom:2cm}.http-server-breadcrumbs{font-size:130%;margin:0 0 15px 0}#footer{font-size:.75em;padding:5px 30px;border-top:1px solid #ddd;text-align:right}#footer p{margin:0 0 0 1em;display:inline-block}#footer p:last-child{margin-right:30px}h1,h2,h3,h4,h5{font-weight:300}h1{font-size:2.5em;line-height:1.1em}h2{font-size:1.75em;margin:1em 0 .50em 0}h3{font-size:1.4em;margin:25px 0 10px 0}h4{margin:0;font-size:105%}h1:target,h2:target,h3:target,h4:target,h5:target,h6:target{background:var(--highlight-color);padding:.2em 0}a{color:#058;text-decoration:none;transition:color .3s ease-in-out}a:hover{color:#e82}.title code{font-weight:bold}h2[id^="header-"]{margin-top:2em}.ident{color:#900}pre code{background:#f8f8f8;font-size:.8em;line-height:1.4em}code{background:#f2f2f1;padding:1px 4px;overflow-wrap:break-word}h1 code{background:transparent}pre{background:#f8f8f8;border:0;border-top:1px solid #ccc;border-bottom:1px solid #ccc;margin:1em 0;padding:1ex}#http-server-module-list{display:flex;flex-flow:column}#http-server-module-list div{display:flex}#http-server-module-list dt{min-width:10%}#http-server-module-list p{margin-top:0}.toc ul,#index{list-style-type:none;margin:0;padding:0}#index code{background:transparent}#index h3{border-bottom:1px solid #ddd}#index ul{padding:0}#index h4{margin-top:.6em;font-weight:bold}@media (min-width:200ex){#index .two-column{column-count:2}}@media (min-width:300ex){#index .two-column{column-count:3}}dl{margin-bottom:2em}dl dl:last-child{margin-bottom:4em}dd{margin:0 0 1em 3em}#header-classes + dl > dd{margin-bottom:3em}dd dd{margin-left:2em}dd p{margin:10px 0}.name{background:#eee;font-weight:bold;font-size:.85em;padding:5px 10px;display:inline-block;min-width:40%}.name:hover{background:#e0e0e0}dt:target .name{background:var(--highlight-color)}.name > span:first-child{white-space:nowrap}.name.class > span:nth-child(2){margin-left:.4em}.inherited{color:#999;border-left:5px solid #eee;padding-left:1em}.inheritance em{font-style:normal;font-weight:bold}.desc h2{font-weight:400;font-size:1.25em}.desc h3{font-size:1em}.desc dt code{background:inherit}.source summary,.git-link-div{color:#666;text-align:right;font-weight:400;font-size:.8em;text-transform:uppercase}.source summary > *{white-space:nowrap;cursor:pointer}.git-link{color:inherit;margin-left:1em}.source pre{max-height:500px;overflow:auto;margin:0}.source pre code{font-size:12px;overflow:visible}.hlist{list-style:none}.hlist li{display:inline}.hlist li:after{content:',\2002'}.hlist li:last-child:after{content:none}.hlist .hlist{display:inline;padding-left:1em}img{max-width:100%}td{padding:0 .5em}.admonition{padding:.1em .5em;margin-bottom:1em}.admonition-title{font-weight:bold}.admonition.note,.admonition.info,.admonition.important{background:#aef}.admonition.todo,.admonition.versionadded,.admonition.tip,.admonition.hint{background:#dfd}.admonition.warning,.admonition.versionchanged,.admonition.deprecated{background:#fd4}.admonition.error,.admonition.danger,.admonition.caution{background:lightpink}</style>
<style media="screen and (min-width: 700px)">@media screen and (min-width:700px){#sidebar{width:30%;height:100vh;overflow:auto;position:sticky;top:0}#content{width:70%;max-width:100ch;padding:3em 4em;border-left:1px solid #ddd}pre code{font-size:1em}.item .name{font-size:1em}main{display:flex;flex-direction:row-reverse;justify-content:flex-end}.toc ul ul,#index ul{padding-left:1.5em}.toc > ul > li{margin-top:.5em}}</style>
<style media="print">@media print{#sidebar h1{page-break-before:always}.source{display:none}}@media print{*{background:transparent !important;color:#000 !important;box-shadow:none !important;text-shadow:none !important}a[href]:after{content:" (" attr(href) ")";font-size:90%}a[href][title]:after{content:none}abbr[title]:after{content:" (" attr(title) ")"}.ir a:after,a[href^="javascript:"]:after,a[href^="#"]:after{content:""}pre,blockquote{border:1px solid #999;page-break-inside:avoid}thead{display:table-header-group}tr,img{page-break-inside:avoid}img{max-width:100% !important}@page{margin:0.5cm}p,h2,h3{orphans:3;widows:3}h1,h2,h3,h4,h5,h6{page-break-after:avoid}}</style>
<script defer src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/highlight.min.js" integrity="sha256-Uv3H6lx7dJmRfRvH8TH6kJD1TSK1aFcwgx+mdg3epi8=" crossorigin></script>
<script>window.addEventListener('DOMContentLoaded', () => hljs.initHighlighting())</script>
</head>
<body>
<main>
<article id="content">
<header>
<h1 class="title">Module <code>corems.molecular_formula.factory.MolecularFormulaFactory</code></h1>
</header>
<section id="section-intro">
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">from copy import deepcopy
from collections import OrderedDict
from corems.molecular_formula.calc.MolecularFormulaCalc import MolecularFormulaCalc
from corems.encapsulation.constant import Atoms, Labels
from numpy import nan
import re

__author__ = &#34;Yuri E. Corilo&#34;
__date__ = &#34;Jun 24, 2019&#34;

class MolecularFormula(MolecularFormulaCalc):
    &#39;&#39;&#39;
    classdocs
    &#39;&#39;&#39;
    def __init__(self, molecular_formula, ion_charge, ion_type=None, adduct_atom=None, mspeak_parent=None):
        
        #clear dictionary of atoms with 0 value
        
        if   type(molecular_formula) is dict:
                self._from_dict(molecular_formula, ion_type, adduct_atom)   
        
        elif type(molecular_formula) is list:
                self._from_list(molecular_formula, ion_type, adduct_atom)   
        
        elif type(molecular_formula) is str:
                self._from_str(molecular_formula, ion_type, adduct_atom)   

        
        self._ion_charge = ion_charge

        self._confidence_score = None        
        self._isotopologue_similarity = None
        self._mz_error_score = None
        self._mass_error_average_score = None

        self.is_isotopologue = False

        # parent mass spectrum peak obj instance
        self._mspeak_parent = mspeak_parent

        self.expected_isotopologues = []
        self.mspeak_mf_isotopologues_indexes = []
        
        if self._mspeak_parent:
            kendrick_dict_base = self._mspeak_parent._ms_parent.kendrick_base
        else:
            kendrick_dict_base = {&#39;C&#39;:1, &#39;H&#39;:2}
        self._kdm, self._kendrick_mass, self._nominal_km = self._calc_kdm(
            kendrick_dict_base)  
        
    def __repr__(self):

        return &#34;MolecularFormula({0},{1},ion type = {2}&#34;.format(self._d_molecular_formula, self.ion_charge, self.ion_type)
    
    def __str__(self):

        return &#34;MolecularFormula {0}, ion_charge:{1}, ion type:{2}, m/z:{3} &#34;.format(self.string, self.ion_charge, self.ion_type, self.mz_calc)
    
    def __len__(self):
        
        #crash if keys are not ordered
            return len(self._d_molecular_formula.keys())
        
    def __getitem__(self, atom):
        
            #atom = list(self._d_molecular_formula.keys())[position]
            if atom in self._d_molecular_formula.keys():
                return self._d_molecular_formula[atom]
            else:
                return 0
    
    def get(self, atom):
        
            #atom = list(self._d_molecular_formula.keys())[position]
            if atom in self._d_molecular_formula.keys():
                return self._d_molecular_formula[atom]
            else:
                return 0
                
    def _from_dict(self, molecular_formula, ion_type, adduct_atom):
        
        self._d_molecular_formula = {key:val for key, val in molecular_formula.items() if val != 0}
        if ion_type:
            self._d_molecular_formula[Labels.ion_type] = ion_type
        if adduct_atom:
            if adduct_atom in self._d_molecular_formula:
                self._d_molecular_formula[adduct_atom] += 1 
            else: self._d_molecular_formula[adduct_atom] = 1 

        
    @property
    def isotopologue_count_percentile(self, ):
        if not len(self.expected_isotopologues) == 0:
            return (len(self.mspeak_mf_isotopologues_indexes)/len(self.expected_isotopologues))*100
        else: 
            return 100

    def _from_list(self, molecular_formula_list, ion_type, adduct_atom):
        # list has to be in the format 
        #[&#39;C&#39;, 10, &#39;H&#39;, 21, &#39;13C&#39;, 1, &#39;Cl&#39;, 1, etc]  
        self._d_molecular_formula = {}
        for each in range(0, len(molecular_formula_list),2):
            
            atoms_label =  molecular_formula_list[each]
            atoms_count = int(molecular_formula_list[each+1])
            if atoms_count &gt; 0:
                self._d_molecular_formula[atoms_label] = int(atoms_count)
        
        self._d_molecular_formula[Labels.ion_type] = ion_type
        if adduct_atom:
            if adduct_atom in self._d_molecular_formula:
                self._d_molecular_formula[adduct_atom] += 1 
            else: self._d_molecular_formula[adduct_atom] = 1 

    def _from_str(self, molecular_formula_str,  ion_type, adduct_atom):
        # string has to be in the format 
        #&#39;C10 H21 13C1 Cl1 37Cl1 etc&#39;
        molecular_formula_list = molecular_formula_str.split(&#39; &#39;)
        final_formula = []
        for i in molecular_formula_list:
            atoms_count = self.split(Atoms.atoms_order, i)
            final_formula.extend(atoms_count)
        print(final_formula)
        self._from_list(final_formula, ion_type, adduct_atom)

    def split(self, delimiters, string, maxsplit=0): #pragma: no cover
        
        &#39;&#39;&#39; does not work when formula has atoms with same caracaters:
            i.e - C10H21NNa
        &#39;&#39;&#39;
        regexPattern = &#39;|&#39;.join(map(re.escape, delimiters)) #pragma: no cover
        isotopes = re.findall(regexPattern, string) #pragma: no cover
        counts = re.split(regexPattern, string, maxsplit)  #pragma: no cover
       
        return [isotopes[0], int(counts[1])]

    @property
    def O_C(self): 
            
            if &#39;O&#39; in self._d_molecular_formula.keys():
                return self._d_molecular_formula.get(&#34;O&#34;)/self._d_molecular_formula.get(&#34;C&#34;)
            else:
                return 0    
    
    @property
    def H_C(self): return self._d_molecular_formula.get(&#34;H&#34;)/self._d_molecular_formula.get(&#34;C&#34;)
    
    @property
    def dbe(self): return self._calc_dbe()
    
    @property
    def mz_nominal_calc(self): return int(self._calc_mz())

    @property    
    def mz_error(self): return self._calc_assignment_mass_error()

    @property
    def mz_calc(self): return self._calc_mz()

    @property
    def ion_type(self): 
        
        ion_type = self._d_molecular_formula.get(Labels.ion_type)
        if ion_type == Labels.protonated_de_ion:
            if self.ion_charge &gt; 0: 
                return Labels.protonated
            else: 
                return Labels.de_protonated    
        else:
            return ion_type

    @ion_type.setter
    def ion_type(self, ion_type):
        if  ion_type in [Labels.protonated_de_ion, Labels.adduct_ion, Labels.radical_ion]:
            self._d_molecular_formula[Labels.ion_type] = ion_type
        else:
            raise TypeError(&#34;Ion type can only be: &#39;DE_OR_PROTONATED&#39;, &#39;RADICAL&#39; or  &#39;ADDUCT&#39;, not %s&#34;%ion_type)   

    @property
    def ion_charge(self): return self._ion_charge
    
    @property
    def atoms(self): return [key for key in self._d_molecular_formula.keys() if key != Labels.ion_type]
    
    @property
    def confidence_score(self): 
        
        if not self._confidence_score:
            
            self._confidence_score = self._calc_confidence_score()
        
        return self._confidence_score

    @property
    def isotopologue_similarity(self): 
        
        if not self._isotopologue_similarity:
           
           self._isotopologue_similarity = self._calc_isotopologue_confidence()  
       
        return self._isotopologue_similarity  
    
    @property
    def average_mz_error_score(self): 
        
        &#39;&#39;&#39; includes the isotopologues&#39;&#39;&#39;
        
        if not self._mass_error_average_score:
           
           self._mass_error_average_score = self._calc_average_mz_score()  
        
        return self._mass_error_average_score

    @property
    def mz_error_score(self): 
        if not self._mz_error_score:
           
           self._mz_error_score = self._calc_mz_confidence()  
        
        return self._mz_error_score
    
    @property
    def kmd(self): return self._kdm

    @property
    def kendrick_mass(self): return self._kendrick_mass

    @property
    def knm(self): return self._nominal_km

    def change_kendrick_base(self, kendrick_dict_base):
        &#39;&#39;&#39;kendrick_dict_base = {&#34;C&#34;: 1, &#34;H&#34;: 2}&#39;&#39;&#39;
        self._kdm, self._kendrick_mass, self._nominal_km = self._calc_kdm(kendrick_dict_base)
                
    def isotopologues(self, min_abundance, current_mono_abundance, dynamic_range): 
        
        # this calculation ignores the hydrogen
        for mf in self._cal_isotopologues(self._d_molecular_formula, min_abundance, current_mono_abundance, dynamic_range ):
             
            yield MolecularFormulaIsotopologue(*mf, current_mono_abundance, self.ion_charge)
    
    def atoms_qnt(self,atom): 
        if atom in self._d_molecular_formula:
            return self._d_molecular_formula.get(atom)
        else:
            raise Warning(&#39;Could not find %s in this Molecular Formula object&#39;%str(atom))
    
    def atoms_symbol(self, atom): 
        &#39;&#39;&#39;return the atom symbol without the mass number&#39;&#39;&#39;
        return &#39;&#39;.join([i for i in atom if not i.isdigit()])

    @property       
    def string(self):
        
        if self._d_molecular_formula:
            formula_srt = &#39;&#39;
            for atom in Atoms.atoms_order:
                if atom in self.to_dict().keys():
                    formula_srt += atom + str(int(self.to_dict().get(atom))) + &#39; &#39;
            return formula_srt.strip()
        
        else:
            raise Exception(&#34;Molecular formula identification not performed yet&#34;)    
    
    @property
    def string_formated(self):
        
        SUB = str.maketrans(&#34;0123456789&#34;, &#34;₀₁₂₃₄₅₆₇₈₉&#34;)
        SUP = str.maketrans(&#34;0123456789&#34;, &#34;⁰¹²³⁴⁵⁶⁷⁸⁹&#34;)
        
        if self._d_molecular_formula:
            formula_srt = &#39;&#39;
            for atom in Atoms.atoms_order:
                if atom in self.to_dict().keys():
                    formula_srt += atom.translate(SUP) + str(int(self.to_dict().get(atom))).translate(SUB)
            return formula_srt
        
        else:
            raise Exception(&#34;Molecular formula identification not performed yet&#34;)    

    def to_dict(self):
        return self._d_molecular_formula

    def to_list(self):
        &#39;&#39;&#39;TODO ensure self._d_molecular_formula is a orderedDict&#39;&#39;&#39;
        
        if self._d_molecular_formula:
            formula_list = []    
            
            for atom, atom_number in self._d_molecular_formula.items():
    
                if atom != Labels.ion_type:
                    
                    formula_list.append(atom)
                    formula_list.append(atom_number)
    
            return formula_list
        else:
            raise Exception(&#34;Molecular formula identification not performed yet&#34;)
    
    @property
    def class_label(self):
        
        if self._d_molecular_formula:
            
            formulalist = self.to_list()
            classstring = &#39;&#39; 
            
            for each in range(0, len(formulalist),2):
                
                if formulalist[each] != &#39;C&#39; and formulalist[each] != &#39;H&#39; and formulalist[each] != &#39;HC&#39;:
                     
                    classstring = classstring + str(formulalist[each]) + str(formulalist[each+1]) + &#39; &#39;    
            
            if classstring == &#39;&#39;: classstring = &#39;HC&#39;
                
            classstring = classstring.strip()
            
            if self._d_molecular_formula.get(Labels.ion_type) == Labels.radical_ion:    
                
                return classstring + &#39; -R&#39;
            
            #elif self._d_molecular_formula.get(Labels.ion_type) == Labels.adduct_ion:    
                
            #    return classstring + &#39; -A&#39;

            else: return classstring
            
            #&#39;dict, tuple or string&#39;
        
        else:
            
            raise Exception(&#34;Molecular formula identification not performed yet&#34;)        
    
    @property
    def class_dict(self):
        
        if self._d_molecular_formula:
            
            class_dict = {}
            
            for atom, qnt in self._d_molecular_formula.items():
    
                if atom != Labels.ion_type and atom !=&#39;C&#39; and atom !=&#39;H&#39;:
                    
                    class_dict[atom] = qnt
                    
            return class_dict
        
        raise Exception(&#34;Molecular formula identification not performed yet&#34;)           
    

class MolecularFormulaIsotopologue(MolecularFormula):
        
    &#39;&#39;&#39;
    classdocs
    &#39;&#39;&#39;
    def __init__(self, _d_molecular_formula, prob_ratio, mono_abundance, ion_charge, mspeak_parent=None):
        
        super().__init__(_d_molecular_formula,  ion_charge)
        #prob_ratio is relative to the monoisotopic peak p_isotopologue/p_mono_isotopic
        
        self.prob_ratio = prob_ratio
        
        self.abundance_calc = mono_abundance * prob_ratio

        self.is_isotopologue = True
        
        self.mspeak_index_mono_isotopic = None

        self.mono_isotopic_formula_index = None
        # parent mass spectrum peak obj instance
        self._mspeak_parent = mspeak_parent

    
    @property
    def area_error(self):
        return self._calc_area_error()

    @property
    def abundance_error(self):
        return self._calc_abundance_error()

        </code></pre>
</details>
</section>
<section>
</section>
<section>
</section>
<section>
</section>
<section>
<h2 class="section-title" id="header-classes">Classes</h2>
<dl>
<dt id="corems.molecular_formula.factory.MolecularFormulaFactory.MolecularFormula"><code class="flex name class">
<span>class <span class="ident">MolecularFormula</span></span>
<span>(</span><span>molecular_formula, ion_charge, ion_type=None, adduct_atom=None, mspeak_parent=None)</span>
</code></dt>
<dd>
<div class="desc"><p>classdocs</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class MolecularFormula(MolecularFormulaCalc):
    &#39;&#39;&#39;
    classdocs
    &#39;&#39;&#39;
    def __init__(self, molecular_formula, ion_charge, ion_type=None, adduct_atom=None, mspeak_parent=None):
        
        #clear dictionary of atoms with 0 value
        
        if   type(molecular_formula) is dict:
                self._from_dict(molecular_formula, ion_type, adduct_atom)   
        
        elif type(molecular_formula) is list:
                self._from_list(molecular_formula, ion_type, adduct_atom)   
        
        elif type(molecular_formula) is str:
                self._from_str(molecular_formula, ion_type, adduct_atom)   

        
        self._ion_charge = ion_charge

        self._confidence_score = None        
        self._isotopologue_similarity = None
        self._mz_error_score = None
        self._mass_error_average_score = None

        self.is_isotopologue = False

        # parent mass spectrum peak obj instance
        self._mspeak_parent = mspeak_parent

        self.expected_isotopologues = []
        self.mspeak_mf_isotopologues_indexes = []
        
        if self._mspeak_parent:
            kendrick_dict_base = self._mspeak_parent._ms_parent.kendrick_base
        else:
            kendrick_dict_base = {&#39;C&#39;:1, &#39;H&#39;:2}
        self._kdm, self._kendrick_mass, self._nominal_km = self._calc_kdm(
            kendrick_dict_base)  
        
    def __repr__(self):

        return &#34;MolecularFormula({0},{1},ion type = {2}&#34;.format(self._d_molecular_formula, self.ion_charge, self.ion_type)
    
    def __str__(self):

        return &#34;MolecularFormula {0}, ion_charge:{1}, ion type:{2}, m/z:{3} &#34;.format(self.string, self.ion_charge, self.ion_type, self.mz_calc)
    
    def __len__(self):
        
        #crash if keys are not ordered
            return len(self._d_molecular_formula.keys())
        
    def __getitem__(self, atom):
        
            #atom = list(self._d_molecular_formula.keys())[position]
            if atom in self._d_molecular_formula.keys():
                return self._d_molecular_formula[atom]
            else:
                return 0
    
    def get(self, atom):
        
            #atom = list(self._d_molecular_formula.keys())[position]
            if atom in self._d_molecular_formula.keys():
                return self._d_molecular_formula[atom]
            else:
                return 0
                
    def _from_dict(self, molecular_formula, ion_type, adduct_atom):
        
        self._d_molecular_formula = {key:val for key, val in molecular_formula.items() if val != 0}
        if ion_type:
            self._d_molecular_formula[Labels.ion_type] = ion_type
        if adduct_atom:
            if adduct_atom in self._d_molecular_formula:
                self._d_molecular_formula[adduct_atom] += 1 
            else: self._d_molecular_formula[adduct_atom] = 1 

        
    @property
    def isotopologue_count_percentile(self, ):
        if not len(self.expected_isotopologues) == 0:
            return (len(self.mspeak_mf_isotopologues_indexes)/len(self.expected_isotopologues))*100
        else: 
            return 100

    def _from_list(self, molecular_formula_list, ion_type, adduct_atom):
        # list has to be in the format 
        #[&#39;C&#39;, 10, &#39;H&#39;, 21, &#39;13C&#39;, 1, &#39;Cl&#39;, 1, etc]  
        self._d_molecular_formula = {}
        for each in range(0, len(molecular_formula_list),2):
            
            atoms_label =  molecular_formula_list[each]
            atoms_count = int(molecular_formula_list[each+1])
            if atoms_count &gt; 0:
                self._d_molecular_formula[atoms_label] = int(atoms_count)
        
        self._d_molecular_formula[Labels.ion_type] = ion_type
        if adduct_atom:
            if adduct_atom in self._d_molecular_formula:
                self._d_molecular_formula[adduct_atom] += 1 
            else: self._d_molecular_formula[adduct_atom] = 1 

    def _from_str(self, molecular_formula_str,  ion_type, adduct_atom):
        # string has to be in the format 
        #&#39;C10 H21 13C1 Cl1 37Cl1 etc&#39;
        molecular_formula_list = molecular_formula_str.split(&#39; &#39;)
        final_formula = []
        for i in molecular_formula_list:
            atoms_count = self.split(Atoms.atoms_order, i)
            final_formula.extend(atoms_count)
        print(final_formula)
        self._from_list(final_formula, ion_type, adduct_atom)

    def split(self, delimiters, string, maxsplit=0): #pragma: no cover
        
        &#39;&#39;&#39; does not work when formula has atoms with same caracaters:
            i.e - C10H21NNa
        &#39;&#39;&#39;
        regexPattern = &#39;|&#39;.join(map(re.escape, delimiters)) #pragma: no cover
        isotopes = re.findall(regexPattern, string) #pragma: no cover
        counts = re.split(regexPattern, string, maxsplit)  #pragma: no cover
       
        return [isotopes[0], int(counts[1])]

    @property
    def O_C(self): 
            
            if &#39;O&#39; in self._d_molecular_formula.keys():
                return self._d_molecular_formula.get(&#34;O&#34;)/self._d_molecular_formula.get(&#34;C&#34;)
            else:
                return 0    
    
    @property
    def H_C(self): return self._d_molecular_formula.get(&#34;H&#34;)/self._d_molecular_formula.get(&#34;C&#34;)
    
    @property
    def dbe(self): return self._calc_dbe()
    
    @property
    def mz_nominal_calc(self): return int(self._calc_mz())

    @property    
    def mz_error(self): return self._calc_assignment_mass_error()

    @property
    def mz_calc(self): return self._calc_mz()

    @property
    def ion_type(self): 
        
        ion_type = self._d_molecular_formula.get(Labels.ion_type)
        if ion_type == Labels.protonated_de_ion:
            if self.ion_charge &gt; 0: 
                return Labels.protonated
            else: 
                return Labels.de_protonated    
        else:
            return ion_type

    @ion_type.setter
    def ion_type(self, ion_type):
        if  ion_type in [Labels.protonated_de_ion, Labels.adduct_ion, Labels.radical_ion]:
            self._d_molecular_formula[Labels.ion_type] = ion_type
        else:
            raise TypeError(&#34;Ion type can only be: &#39;DE_OR_PROTONATED&#39;, &#39;RADICAL&#39; or  &#39;ADDUCT&#39;, not %s&#34;%ion_type)   

    @property
    def ion_charge(self): return self._ion_charge
    
    @property
    def atoms(self): return [key for key in self._d_molecular_formula.keys() if key != Labels.ion_type]
    
    @property
    def confidence_score(self): 
        
        if not self._confidence_score:
            
            self._confidence_score = self._calc_confidence_score()
        
        return self._confidence_score

    @property
    def isotopologue_similarity(self): 
        
        if not self._isotopologue_similarity:
           
           self._isotopologue_similarity = self._calc_isotopologue_confidence()  
       
        return self._isotopologue_similarity  
    
    @property
    def average_mz_error_score(self): 
        
        &#39;&#39;&#39; includes the isotopologues&#39;&#39;&#39;
        
        if not self._mass_error_average_score:
           
           self._mass_error_average_score = self._calc_average_mz_score()  
        
        return self._mass_error_average_score

    @property
    def mz_error_score(self): 
        if not self._mz_error_score:
           
           self._mz_error_score = self._calc_mz_confidence()  
        
        return self._mz_error_score
    
    @property
    def kmd(self): return self._kdm

    @property
    def kendrick_mass(self): return self._kendrick_mass

    @property
    def knm(self): return self._nominal_km

    def change_kendrick_base(self, kendrick_dict_base):
        &#39;&#39;&#39;kendrick_dict_base = {&#34;C&#34;: 1, &#34;H&#34;: 2}&#39;&#39;&#39;
        self._kdm, self._kendrick_mass, self._nominal_km = self._calc_kdm(kendrick_dict_base)
                
    def isotopologues(self, min_abundance, current_mono_abundance, dynamic_range): 
        
        # this calculation ignores the hydrogen
        for mf in self._cal_isotopologues(self._d_molecular_formula, min_abundance, current_mono_abundance, dynamic_range ):
             
            yield MolecularFormulaIsotopologue(*mf, current_mono_abundance, self.ion_charge)
    
    def atoms_qnt(self,atom): 
        if atom in self._d_molecular_formula:
            return self._d_molecular_formula.get(atom)
        else:
            raise Warning(&#39;Could not find %s in this Molecular Formula object&#39;%str(atom))
    
    def atoms_symbol(self, atom): 
        &#39;&#39;&#39;return the atom symbol without the mass number&#39;&#39;&#39;
        return &#39;&#39;.join([i for i in atom if not i.isdigit()])

    @property       
    def string(self):
        
        if self._d_molecular_formula:
            formula_srt = &#39;&#39;
            for atom in Atoms.atoms_order:
                if atom in self.to_dict().keys():
                    formula_srt += atom + str(int(self.to_dict().get(atom))) + &#39; &#39;
            return formula_srt.strip()
        
        else:
            raise Exception(&#34;Molecular formula identification not performed yet&#34;)    
    
    @property
    def string_formated(self):
        
        SUB = str.maketrans(&#34;0123456789&#34;, &#34;₀₁₂₃₄₅₆₇₈₉&#34;)
        SUP = str.maketrans(&#34;0123456789&#34;, &#34;⁰¹²³⁴⁵⁶⁷⁸⁹&#34;)
        
        if self._d_molecular_formula:
            formula_srt = &#39;&#39;
            for atom in Atoms.atoms_order:
                if atom in self.to_dict().keys():
                    formula_srt += atom.translate(SUP) + str(int(self.to_dict().get(atom))).translate(SUB)
            return formula_srt
        
        else:
            raise Exception(&#34;Molecular formula identification not performed yet&#34;)    

    def to_dict(self):
        return self._d_molecular_formula

    def to_list(self):
        &#39;&#39;&#39;TODO ensure self._d_molecular_formula is a orderedDict&#39;&#39;&#39;
        
        if self._d_molecular_formula:
            formula_list = []    
            
            for atom, atom_number in self._d_molecular_formula.items():
    
                if atom != Labels.ion_type:
                    
                    formula_list.append(atom)
                    formula_list.append(atom_number)
    
            return formula_list
        else:
            raise Exception(&#34;Molecular formula identification not performed yet&#34;)
    
    @property
    def class_label(self):
        
        if self._d_molecular_formula:
            
            formulalist = self.to_list()
            classstring = &#39;&#39; 
            
            for each in range(0, len(formulalist),2):
                
                if formulalist[each] != &#39;C&#39; and formulalist[each] != &#39;H&#39; and formulalist[each] != &#39;HC&#39;:
                     
                    classstring = classstring + str(formulalist[each]) + str(formulalist[each+1]) + &#39; &#39;    
            
            if classstring == &#39;&#39;: classstring = &#39;HC&#39;
                
            classstring = classstring.strip()
            
            if self._d_molecular_formula.get(Labels.ion_type) == Labels.radical_ion:    
                
                return classstring + &#39; -R&#39;
            
            #elif self._d_molecular_formula.get(Labels.ion_type) == Labels.adduct_ion:    
                
            #    return classstring + &#39; -A&#39;

            else: return classstring
            
            #&#39;dict, tuple or string&#39;
        
        else:
            
            raise Exception(&#34;Molecular formula identification not performed yet&#34;)        
    
    @property
    def class_dict(self):
        
        if self._d_molecular_formula:
            
            class_dict = {}
            
            for atom, qnt in self._d_molecular_formula.items():
    
                if atom != Labels.ion_type and atom !=&#39;C&#39; and atom !=&#39;H&#39;:
                    
                    class_dict[atom] = qnt
                    
            return class_dict
        
        raise Exception(&#34;Molecular formula identification not performed yet&#34;)           </code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="corems.molecular_formula.calc.MolecularFormulaCalc.MolecularFormulaCalc" href="../calc/MolecularFormulaCalc.html#corems.molecular_formula.calc.MolecularFormulaCalc.MolecularFormulaCalc">MolecularFormulaCalc</a></li>
</ul>
<h3>Subclasses</h3>
<ul class="hlist">
<li><a title="corems.molecular_formula.factory.MolecularFormulaFactory.MolecularFormulaIsotopologue" href="#corems.molecular_formula.factory.MolecularFormulaFactory.MolecularFormulaIsotopologue">MolecularFormulaIsotopologue</a></li>
</ul>
<h3>Instance variables</h3>
<dl>
<dt id="corems.molecular_formula.factory.MolecularFormulaFactory.MolecularFormula.H_C"><code class="name">var <span class="ident">H_C</span></code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">@property
def H_C(self): return self._d_molecular_formula.get(&#34;H&#34;)/self._d_molecular_formula.get(&#34;C&#34;)</code></pre>
</details>
</dd>
<dt id="corems.molecular_formula.factory.MolecularFormulaFactory.MolecularFormula.O_C"><code class="name">var <span class="ident">O_C</span></code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">@property
def O_C(self): 
        
        if &#39;O&#39; in self._d_molecular_formula.keys():
            return self._d_molecular_formula.get(&#34;O&#34;)/self._d_molecular_formula.get(&#34;C&#34;)
        else:
            return 0    </code></pre>
</details>
</dd>
<dt id="corems.molecular_formula.factory.MolecularFormulaFactory.MolecularFormula.atoms"><code class="name">var <span class="ident">atoms</span></code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">@property
def atoms(self): return [key for key in self._d_molecular_formula.keys() if key != Labels.ion_type]</code></pre>
</details>
</dd>
<dt id="corems.molecular_formula.factory.MolecularFormulaFactory.MolecularFormula.average_mz_error_score"><code class="name">var <span class="ident">average_mz_error_score</span></code></dt>
<dd>
<div class="desc"><p>includes the isotopologues</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">@property
def average_mz_error_score(self): 
    
    &#39;&#39;&#39; includes the isotopologues&#39;&#39;&#39;
    
    if not self._mass_error_average_score:
       
       self._mass_error_average_score = self._calc_average_mz_score()  
    
    return self._mass_error_average_score</code></pre>
</details>
</dd>
<dt id="corems.molecular_formula.factory.MolecularFormulaFactory.MolecularFormula.class_dict"><code class="name">var <span class="ident">class_dict</span></code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">@property
def class_dict(self):
    
    if self._d_molecular_formula:
        
        class_dict = {}
        
        for atom, qnt in self._d_molecular_formula.items():

            if atom != Labels.ion_type and atom !=&#39;C&#39; and atom !=&#39;H&#39;:
                
                class_dict[atom] = qnt
                
        return class_dict
    
    raise Exception(&#34;Molecular formula identification not performed yet&#34;)           </code></pre>
</details>
</dd>
<dt id="corems.molecular_formula.factory.MolecularFormulaFactory.MolecularFormula.class_label"><code class="name">var <span class="ident">class_label</span></code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">@property
def class_label(self):
    
    if self._d_molecular_formula:
        
        formulalist = self.to_list()
        classstring = &#39;&#39; 
        
        for each in range(0, len(formulalist),2):
            
            if formulalist[each] != &#39;C&#39; and formulalist[each] != &#39;H&#39; and formulalist[each] != &#39;HC&#39;:
                 
                classstring = classstring + str(formulalist[each]) + str(formulalist[each+1]) + &#39; &#39;    
        
        if classstring == &#39;&#39;: classstring = &#39;HC&#39;
            
        classstring = classstring.strip()
        
        if self._d_molecular_formula.get(Labels.ion_type) == Labels.radical_ion:    
            
            return classstring + &#39; -R&#39;
        
        #elif self._d_molecular_formula.get(Labels.ion_type) == Labels.adduct_ion:    
            
        #    return classstring + &#39; -A&#39;

        else: return classstring
        
        #&#39;dict, tuple or string&#39;
    
    else:
        
        raise Exception(&#34;Molecular formula identification not performed yet&#34;)        </code></pre>
</details>
</dd>
<dt id="corems.molecular_formula.factory.MolecularFormulaFactory.MolecularFormula.confidence_score"><code class="name">var <span class="ident">confidence_score</span></code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">@property
def confidence_score(self): 
    
    if not self._confidence_score:
        
        self._confidence_score = self._calc_confidence_score()
    
    return self._confidence_score</code></pre>
</details>
</dd>
<dt id="corems.molecular_formula.factory.MolecularFormulaFactory.MolecularFormula.dbe"><code class="name">var <span class="ident">dbe</span></code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">@property
def dbe(self): return self._calc_dbe()</code></pre>
</details>
</dd>
<dt id="corems.molecular_formula.factory.MolecularFormulaFactory.MolecularFormula.ion_charge"><code class="name">var <span class="ident">ion_charge</span></code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">@property
def ion_charge(self): return self._ion_charge</code></pre>
</details>
</dd>
<dt id="corems.molecular_formula.factory.MolecularFormulaFactory.MolecularFormula.ion_type"><code class="name">var <span class="ident">ion_type</span></code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">@property
def ion_type(self): 
    
    ion_type = self._d_molecular_formula.get(Labels.ion_type)
    if ion_type == Labels.protonated_de_ion:
        if self.ion_charge &gt; 0: 
            return Labels.protonated
        else: 
            return Labels.de_protonated    
    else:
        return ion_type</code></pre>
</details>
</dd>
<dt id="corems.molecular_formula.factory.MolecularFormulaFactory.MolecularFormula.isotopologue_count_percentile"><code class="name">var <span class="ident">isotopologue_count_percentile</span></code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">@property
def isotopologue_count_percentile(self, ):
    if not len(self.expected_isotopologues) == 0:
        return (len(self.mspeak_mf_isotopologues_indexes)/len(self.expected_isotopologues))*100
    else: 
        return 100</code></pre>
</details>
</dd>
<dt id="corems.molecular_formula.factory.MolecularFormulaFactory.MolecularFormula.isotopologue_similarity"><code class="name">var <span class="ident">isotopologue_similarity</span></code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">@property
def isotopologue_similarity(self): 
    
    if not self._isotopologue_similarity:
       
       self._isotopologue_similarity = self._calc_isotopologue_confidence()  
   
    return self._isotopologue_similarity  </code></pre>
</details>
</dd>
<dt id="corems.molecular_formula.factory.MolecularFormulaFactory.MolecularFormula.kendrick_mass"><code class="name">var <span class="ident">kendrick_mass</span></code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">@property
def kendrick_mass(self): return self._kendrick_mass</code></pre>
</details>
</dd>
<dt id="corems.molecular_formula.factory.MolecularFormulaFactory.MolecularFormula.kmd"><code class="name">var <span class="ident">kmd</span></code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">@property
def kmd(self): return self._kdm</code></pre>
</details>
</dd>
<dt id="corems.molecular_formula.factory.MolecularFormulaFactory.MolecularFormula.knm"><code class="name">var <span class="ident">knm</span></code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">@property
def knm(self): return self._nominal_km</code></pre>
</details>
</dd>
<dt id="corems.molecular_formula.factory.MolecularFormulaFactory.MolecularFormula.mz_calc"><code class="name">var <span class="ident">mz_calc</span></code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">@property
def mz_calc(self): return self._calc_mz()</code></pre>
</details>
</dd>
<dt id="corems.molecular_formula.factory.MolecularFormulaFactory.MolecularFormula.mz_error"><code class="name">var <span class="ident">mz_error</span></code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">@property    
def mz_error(self): return self._calc_assignment_mass_error()</code></pre>
</details>
</dd>
<dt id="corems.molecular_formula.factory.MolecularFormulaFactory.MolecularFormula.mz_error_score"><code class="name">var <span class="ident">mz_error_score</span></code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">@property
def mz_error_score(self): 
    if not self._mz_error_score:
       
       self._mz_error_score = self._calc_mz_confidence()  
    
    return self._mz_error_score</code></pre>
</details>
</dd>
<dt id="corems.molecular_formula.factory.MolecularFormulaFactory.MolecularFormula.mz_nominal_calc"><code class="name">var <span class="ident">mz_nominal_calc</span></code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">@property
def mz_nominal_calc(self): return int(self._calc_mz())</code></pre>
</details>
</dd>
<dt id="corems.molecular_formula.factory.MolecularFormulaFactory.MolecularFormula.string"><code class="name">var <span class="ident">string</span></code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">@property       
def string(self):
    
    if self._d_molecular_formula:
        formula_srt = &#39;&#39;
        for atom in Atoms.atoms_order:
            if atom in self.to_dict().keys():
                formula_srt += atom + str(int(self.to_dict().get(atom))) + &#39; &#39;
        return formula_srt.strip()
    
    else:
        raise Exception(&#34;Molecular formula identification not performed yet&#34;)    </code></pre>
</details>
</dd>
<dt id="corems.molecular_formula.factory.MolecularFormulaFactory.MolecularFormula.string_formated"><code class="name">var <span class="ident">string_formated</span></code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">@property
def string_formated(self):
    
    SUB = str.maketrans(&#34;0123456789&#34;, &#34;₀₁₂₃₄₅₆₇₈₉&#34;)
    SUP = str.maketrans(&#34;0123456789&#34;, &#34;⁰¹²³⁴⁵⁶⁷⁸⁹&#34;)
    
    if self._d_molecular_formula:
        formula_srt = &#39;&#39;
        for atom in Atoms.atoms_order:
            if atom in self.to_dict().keys():
                formula_srt += atom.translate(SUP) + str(int(self.to_dict().get(atom))).translate(SUB)
        return formula_srt
    
    else:
        raise Exception(&#34;Molecular formula identification not performed yet&#34;)    </code></pre>
</details>
</dd>
</dl>
<h3>Methods</h3>
<dl>
<dt id="corems.molecular_formula.factory.MolecularFormulaFactory.MolecularFormula.atoms_qnt"><code class="name flex">
<span>def <span class="ident">atoms_qnt</span></span>(<span>self, atom)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def atoms_qnt(self,atom): 
    if atom in self._d_molecular_formula:
        return self._d_molecular_formula.get(atom)
    else:
        raise Warning(&#39;Could not find %s in this Molecular Formula object&#39;%str(atom))</code></pre>
</details>
</dd>
<dt id="corems.molecular_formula.factory.MolecularFormulaFactory.MolecularFormula.atoms_symbol"><code class="name flex">
<span>def <span class="ident">atoms_symbol</span></span>(<span>self, atom)</span>
</code></dt>
<dd>
<div class="desc"><p>return the atom symbol without the mass number</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def atoms_symbol(self, atom): 
    &#39;&#39;&#39;return the atom symbol without the mass number&#39;&#39;&#39;
    return &#39;&#39;.join([i for i in atom if not i.isdigit()])</code></pre>
</details>
</dd>
<dt id="corems.molecular_formula.factory.MolecularFormulaFactory.MolecularFormula.change_kendrick_base"><code class="name flex">
<span>def <span class="ident">change_kendrick_base</span></span>(<span>self, kendrick_dict_base)</span>
</code></dt>
<dd>
<div class="desc"><p>kendrick_dict_base = {"C": 1, "H": 2}</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def change_kendrick_base(self, kendrick_dict_base):
    &#39;&#39;&#39;kendrick_dict_base = {&#34;C&#34;: 1, &#34;H&#34;: 2}&#39;&#39;&#39;
    self._kdm, self._kendrick_mass, self._nominal_km = self._calc_kdm(kendrick_dict_base)</code></pre>
</details>
</dd>
<dt id="corems.molecular_formula.factory.MolecularFormulaFactory.MolecularFormula.get"><code class="name flex">
<span>def <span class="ident">get</span></span>(<span>self, atom)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def get(self, atom):
    
        #atom = list(self._d_molecular_formula.keys())[position]
        if atom in self._d_molecular_formula.keys():
            return self._d_molecular_formula[atom]
        else:
            return 0</code></pre>
</details>
</dd>
<dt id="corems.molecular_formula.factory.MolecularFormulaFactory.MolecularFormula.isotopologues"><code class="name flex">
<span>def <span class="ident">isotopologues</span></span>(<span>self, min_abundance, current_mono_abundance, dynamic_range)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def isotopologues(self, min_abundance, current_mono_abundance, dynamic_range): 
    
    # this calculation ignores the hydrogen
    for mf in self._cal_isotopologues(self._d_molecular_formula, min_abundance, current_mono_abundance, dynamic_range ):
         
        yield MolecularFormulaIsotopologue(*mf, current_mono_abundance, self.ion_charge)</code></pre>
</details>
</dd>
<dt id="corems.molecular_formula.factory.MolecularFormulaFactory.MolecularFormula.split"><code class="name flex">
<span>def <span class="ident">split</span></span>(<span>self, delimiters, string, maxsplit=0)</span>
</code></dt>
<dd>
<div class="desc"><p>does not work when formula has atoms with same caracaters:
i.e - C10H21NNa</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def split(self, delimiters, string, maxsplit=0): #pragma: no cover
    
    &#39;&#39;&#39; does not work when formula has atoms with same caracaters:
        i.e - C10H21NNa
    &#39;&#39;&#39;
    regexPattern = &#39;|&#39;.join(map(re.escape, delimiters)) #pragma: no cover
    isotopes = re.findall(regexPattern, string) #pragma: no cover
    counts = re.split(regexPattern, string, maxsplit)  #pragma: no cover
   
    return [isotopes[0], int(counts[1])]</code></pre>
</details>
</dd>
<dt id="corems.molecular_formula.factory.MolecularFormulaFactory.MolecularFormula.to_dict"><code class="name flex">
<span>def <span class="ident">to_dict</span></span>(<span>self)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def to_dict(self):
    return self._d_molecular_formula</code></pre>
</details>
</dd>
<dt id="corems.molecular_formula.factory.MolecularFormulaFactory.MolecularFormula.to_list"><code class="name flex">
<span>def <span class="ident">to_list</span></span>(<span>self)</span>
</code></dt>
<dd>
<div class="desc"><p>TODO ensure self._d_molecular_formula is a orderedDict</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def to_list(self):
    &#39;&#39;&#39;TODO ensure self._d_molecular_formula is a orderedDict&#39;&#39;&#39;
    
    if self._d_molecular_formula:
        formula_list = []    
        
        for atom, atom_number in self._d_molecular_formula.items():

            if atom != Labels.ion_type:
                
                formula_list.append(atom)
                formula_list.append(atom_number)

        return formula_list
    else:
        raise Exception(&#34;Molecular formula identification not performed yet&#34;)</code></pre>
</details>
</dd>
</dl>
</dd>
<dt id="corems.molecular_formula.factory.MolecularFormulaFactory.MolecularFormulaIsotopologue"><code class="flex name class">
<span>class <span class="ident">MolecularFormulaIsotopologue</span></span>
<span>(</span><span>_d_molecular_formula, prob_ratio, mono_abundance, ion_charge, mspeak_parent=None)</span>
</code></dt>
<dd>
<div class="desc"><p>classdocs</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class MolecularFormulaIsotopologue(MolecularFormula):
        
    &#39;&#39;&#39;
    classdocs
    &#39;&#39;&#39;
    def __init__(self, _d_molecular_formula, prob_ratio, mono_abundance, ion_charge, mspeak_parent=None):
        
        super().__init__(_d_molecular_formula,  ion_charge)
        #prob_ratio is relative to the monoisotopic peak p_isotopologue/p_mono_isotopic
        
        self.prob_ratio = prob_ratio
        
        self.abundance_calc = mono_abundance * prob_ratio

        self.is_isotopologue = True
        
        self.mspeak_index_mono_isotopic = None

        self.mono_isotopic_formula_index = None
        # parent mass spectrum peak obj instance
        self._mspeak_parent = mspeak_parent

    
    @property
    def area_error(self):
        return self._calc_area_error()

    @property
    def abundance_error(self):
        return self._calc_abundance_error()</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="corems.molecular_formula.factory.MolecularFormulaFactory.MolecularFormula" href="#corems.molecular_formula.factory.MolecularFormulaFactory.MolecularFormula">MolecularFormula</a></li>
<li><a title="corems.molecular_formula.calc.MolecularFormulaCalc.MolecularFormulaCalc" href="../calc/MolecularFormulaCalc.html#corems.molecular_formula.calc.MolecularFormulaCalc.MolecularFormulaCalc">MolecularFormulaCalc</a></li>
</ul>
<h3>Instance variables</h3>
<dl>
<dt id="corems.molecular_formula.factory.MolecularFormulaFactory.MolecularFormulaIsotopologue.abundance_error"><code class="name">var <span class="ident">abundance_error</span></code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">@property
def abundance_error(self):
    return self._calc_abundance_error()</code></pre>
</details>
</dd>
<dt id="corems.molecular_formula.factory.MolecularFormulaFactory.MolecularFormulaIsotopologue.area_error"><code class="name">var <span class="ident">area_error</span></code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">@property
def area_error(self):
    return self._calc_area_error()</code></pre>
</details>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="corems.molecular_formula.factory.MolecularFormulaFactory.MolecularFormula" href="#corems.molecular_formula.factory.MolecularFormulaFactory.MolecularFormula">MolecularFormula</a></b></code>:
<ul class="hlist">
<li><code><a title="corems.molecular_formula.factory.MolecularFormulaFactory.MolecularFormula.atoms_symbol" href="#corems.molecular_formula.factory.MolecularFormulaFactory.MolecularFormula.atoms_symbol">atoms_symbol</a></code></li>
<li><code><a title="corems.molecular_formula.factory.MolecularFormulaFactory.MolecularFormula.average_mz_error_score" href="#corems.molecular_formula.factory.MolecularFormulaFactory.MolecularFormula.average_mz_error_score">average_mz_error_score</a></code></li>
<li><code><a title="corems.molecular_formula.factory.MolecularFormulaFactory.MolecularFormula.change_kendrick_base" href="#corems.molecular_formula.factory.MolecularFormulaFactory.MolecularFormula.change_kendrick_base">change_kendrick_base</a></code></li>
<li><code><a title="corems.molecular_formula.factory.MolecularFormulaFactory.MolecularFormula.split" href="#corems.molecular_formula.factory.MolecularFormulaFactory.MolecularFormula.split">split</a></code></li>
<li><code><a title="corems.molecular_formula.factory.MolecularFormulaFactory.MolecularFormula.to_list" href="#corems.molecular_formula.factory.MolecularFormulaFactory.MolecularFormula.to_list">to_list</a></code></li>
</ul>
</li>
</ul>
</dd>
</dl>
</section>
</article>
<nav id="sidebar">
<h1>Index</h1>
<div class="toc">
<ul></ul>
</div>
<ul id="index">
<li><h3>Super-module</h3>
<ul>
<li><code><a title="corems.molecular_formula.factory" href="index.html">corems.molecular_formula.factory</a></code></li>
</ul>
</li>
<li><h3><a href="#header-classes">Classes</a></h3>
<ul>
<li>
<h4><code><a title="corems.molecular_formula.factory.MolecularFormulaFactory.MolecularFormula" href="#corems.molecular_formula.factory.MolecularFormulaFactory.MolecularFormula">MolecularFormula</a></code></h4>
<ul class="">
<li><code><a title="corems.molecular_formula.factory.MolecularFormulaFactory.MolecularFormula.H_C" href="#corems.molecular_formula.factory.MolecularFormulaFactory.MolecularFormula.H_C">H_C</a></code></li>
<li><code><a title="corems.molecular_formula.factory.MolecularFormulaFactory.MolecularFormula.O_C" href="#corems.molecular_formula.factory.MolecularFormulaFactory.MolecularFormula.O_C">O_C</a></code></li>
<li><code><a title="corems.molecular_formula.factory.MolecularFormulaFactory.MolecularFormula.atoms" href="#corems.molecular_formula.factory.MolecularFormulaFactory.MolecularFormula.atoms">atoms</a></code></li>
<li><code><a title="corems.molecular_formula.factory.MolecularFormulaFactory.MolecularFormula.atoms_qnt" href="#corems.molecular_formula.factory.MolecularFormulaFactory.MolecularFormula.atoms_qnt">atoms_qnt</a></code></li>
<li><code><a title="corems.molecular_formula.factory.MolecularFormulaFactory.MolecularFormula.atoms_symbol" href="#corems.molecular_formula.factory.MolecularFormulaFactory.MolecularFormula.atoms_symbol">atoms_symbol</a></code></li>
<li><code><a title="corems.molecular_formula.factory.MolecularFormulaFactory.MolecularFormula.average_mz_error_score" href="#corems.molecular_formula.factory.MolecularFormulaFactory.MolecularFormula.average_mz_error_score">average_mz_error_score</a></code></li>
<li><code><a title="corems.molecular_formula.factory.MolecularFormulaFactory.MolecularFormula.change_kendrick_base" href="#corems.molecular_formula.factory.MolecularFormulaFactory.MolecularFormula.change_kendrick_base">change_kendrick_base</a></code></li>
<li><code><a title="corems.molecular_formula.factory.MolecularFormulaFactory.MolecularFormula.class_dict" href="#corems.molecular_formula.factory.MolecularFormulaFactory.MolecularFormula.class_dict">class_dict</a></code></li>
<li><code><a title="corems.molecular_formula.factory.MolecularFormulaFactory.MolecularFormula.class_label" href="#corems.molecular_formula.factory.MolecularFormulaFactory.MolecularFormula.class_label">class_label</a></code></li>
<li><code><a title="corems.molecular_formula.factory.MolecularFormulaFactory.MolecularFormula.confidence_score" href="#corems.molecular_formula.factory.MolecularFormulaFactory.MolecularFormula.confidence_score">confidence_score</a></code></li>
<li><code><a title="corems.molecular_formula.factory.MolecularFormulaFactory.MolecularFormula.dbe" href="#corems.molecular_formula.factory.MolecularFormulaFactory.MolecularFormula.dbe">dbe</a></code></li>
<li><code><a title="corems.molecular_formula.factory.MolecularFormulaFactory.MolecularFormula.get" href="#corems.molecular_formula.factory.MolecularFormulaFactory.MolecularFormula.get">get</a></code></li>
<li><code><a title="corems.molecular_formula.factory.MolecularFormulaFactory.MolecularFormula.ion_charge" href="#corems.molecular_formula.factory.MolecularFormulaFactory.MolecularFormula.ion_charge">ion_charge</a></code></li>
<li><code><a title="corems.molecular_formula.factory.MolecularFormulaFactory.MolecularFormula.ion_type" href="#corems.molecular_formula.factory.MolecularFormulaFactory.MolecularFormula.ion_type">ion_type</a></code></li>
<li><code><a title="corems.molecular_formula.factory.MolecularFormulaFactory.MolecularFormula.isotopologue_count_percentile" href="#corems.molecular_formula.factory.MolecularFormulaFactory.MolecularFormula.isotopologue_count_percentile">isotopologue_count_percentile</a></code></li>
<li><code><a title="corems.molecular_formula.factory.MolecularFormulaFactory.MolecularFormula.isotopologue_similarity" href="#corems.molecular_formula.factory.MolecularFormulaFactory.MolecularFormula.isotopologue_similarity">isotopologue_similarity</a></code></li>
<li><code><a title="corems.molecular_formula.factory.MolecularFormulaFactory.MolecularFormula.isotopologues" href="#corems.molecular_formula.factory.MolecularFormulaFactory.MolecularFormula.isotopologues">isotopologues</a></code></li>
<li><code><a title="corems.molecular_formula.factory.MolecularFormulaFactory.MolecularFormula.kendrick_mass" href="#corems.molecular_formula.factory.MolecularFormulaFactory.MolecularFormula.kendrick_mass">kendrick_mass</a></code></li>
<li><code><a title="corems.molecular_formula.factory.MolecularFormulaFactory.MolecularFormula.kmd" href="#corems.molecular_formula.factory.MolecularFormulaFactory.MolecularFormula.kmd">kmd</a></code></li>
<li><code><a title="corems.molecular_formula.factory.MolecularFormulaFactory.MolecularFormula.knm" href="#corems.molecular_formula.factory.MolecularFormulaFactory.MolecularFormula.knm">knm</a></code></li>
<li><code><a title="corems.molecular_formula.factory.MolecularFormulaFactory.MolecularFormula.mz_calc" href="#corems.molecular_formula.factory.MolecularFormulaFactory.MolecularFormula.mz_calc">mz_calc</a></code></li>
<li><code><a title="corems.molecular_formula.factory.MolecularFormulaFactory.MolecularFormula.mz_error" href="#corems.molecular_formula.factory.MolecularFormulaFactory.MolecularFormula.mz_error">mz_error</a></code></li>
<li><code><a title="corems.molecular_formula.factory.MolecularFormulaFactory.MolecularFormula.mz_error_score" href="#corems.molecular_formula.factory.MolecularFormulaFactory.MolecularFormula.mz_error_score">mz_error_score</a></code></li>
<li><code><a title="corems.molecular_formula.factory.MolecularFormulaFactory.MolecularFormula.mz_nominal_calc" href="#corems.molecular_formula.factory.MolecularFormulaFactory.MolecularFormula.mz_nominal_calc">mz_nominal_calc</a></code></li>
<li><code><a title="corems.molecular_formula.factory.MolecularFormulaFactory.MolecularFormula.split" href="#corems.molecular_formula.factory.MolecularFormulaFactory.MolecularFormula.split">split</a></code></li>
<li><code><a title="corems.molecular_formula.factory.MolecularFormulaFactory.MolecularFormula.string" href="#corems.molecular_formula.factory.MolecularFormulaFactory.MolecularFormula.string">string</a></code></li>
<li><code><a title="corems.molecular_formula.factory.MolecularFormulaFactory.MolecularFormula.string_formated" href="#corems.molecular_formula.factory.MolecularFormulaFactory.MolecularFormula.string_formated">string_formated</a></code></li>
<li><code><a title="corems.molecular_formula.factory.MolecularFormulaFactory.MolecularFormula.to_dict" href="#corems.molecular_formula.factory.MolecularFormulaFactory.MolecularFormula.to_dict">to_dict</a></code></li>
<li><code><a title="corems.molecular_formula.factory.MolecularFormulaFactory.MolecularFormula.to_list" href="#corems.molecular_formula.factory.MolecularFormulaFactory.MolecularFormula.to_list">to_list</a></code></li>
</ul>
</li>
<li>
<h4><code><a title="corems.molecular_formula.factory.MolecularFormulaFactory.MolecularFormulaIsotopologue" href="#corems.molecular_formula.factory.MolecularFormulaFactory.MolecularFormulaIsotopologue">MolecularFormulaIsotopologue</a></code></h4>
<ul class="">
<li><code><a title="corems.molecular_formula.factory.MolecularFormulaFactory.MolecularFormulaIsotopologue.abundance_error" href="#corems.molecular_formula.factory.MolecularFormulaFactory.MolecularFormulaIsotopologue.abundance_error">abundance_error</a></code></li>
<li><code><a title="corems.molecular_formula.factory.MolecularFormulaFactory.MolecularFormulaIsotopologue.area_error" href="#corems.molecular_formula.factory.MolecularFormulaFactory.MolecularFormulaIsotopologue.area_error">area_error</a></code></li>
</ul>
</li>
</ul>
</li>
</ul>
</nav>
</main>
<footer id="footer">
<p>Generated by <a href="https://pdoc3.github.io/pdoc"><cite>pdoc</cite> 0.9.2</a>.</p>
</footer>
</body>
</html>